<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>Exercise 1: Simple Vert.x Hello World Web Server</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect2">
<h3 id="__strong_exercise_1_strong_simple_vert_x_hello_world_web_server"><strong>Exercise 1:</strong> Simple Vert.x Hello World Web Server</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the FULL Vert.x distribution from <a href="http://vertx.io/">http://vertx.io/</a> and ensure that the <strong>vertx</strong> command is in your path (vertx/bin/vertx)</p>
</li>
<li>
<p>Create a new file <strong>Exercise1.groovy</strong> with the following contents:
.Exercise1/Exercise1.java</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>import io.vertx.core.AbstractVerticle;;
import io.vertx.core.json.JsonObject;;
import io.vertx.core.http.HttpServer;;

public class Exercise1 extends AbstractVerticle {

    public void start() {
        // Create a new HttpServer
        HttpServer server = vertx.createHttpServer();

        // Create a JSON response
        String response = new JsonObject().put("ok", true).encode();

        // Register a request handler for the HttpServer
        server.requestHandler(req -&gt; req.response().end(response));

        // Listen on port 8080 and interface `127.0.0.1`
        server.listen(8080, "127.0.0.1");
    }
}</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Run the verticle with the command <code><strong>vertx run Exercise1.groovy</strong></code></p>
</li>
<li>
<p>You should see a message like: <code>Succeeded in deploying verticle</code></p>
</li>
<li>
<p>Open a browser and point it at: <a href="http://localhost:8080/">http://localhost:8080/</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Next Steps: (see <a href="http://vertx.io/docs/apidocs/io/vertx/core/http/HttpServerResponse.html">HttpServerResponse</a>)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Modify the example above to add a <code>Content-Type</code> response header</p>
</li>
<li>
<p>Modify the example above to add an HTTP response code of 201 to the response</p>
</li>
<li>
<p>Modify the example above to add an HTTP reason phrase of ‘IDUNNO’ to the response</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="__strong_exercise_2_strong_are_you_fluent"><strong>Exercise 2</strong>: Are you fluent?!?!</h3>
<div class="paragraph">
<p>Vert.x APIs are written to be <a href="https://en.wikipedia.org/wiki/Fluent_interface">fluent</a>. This means that you can chain method calls together so that they form a sort of domain specific language which CAN be easier to read. We will modify our first example to use the fluent API in Vert.x to perform the same operations.</p>
</div>
<div class="listingblock">
<div class="title">Exercise2/Exercise2.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AbstractVerticle;;
import io.vertx.core.json.JsonObject;;
import io.vertx.core.json.JsonObject;;

public class Exercise2 extends AbstractVerticle {

    public void start() {
        // Create a JSON response
        String response = new JsonObject().put("ok", true).encode();

        vertx.createHttpServer()         // Create a new HttpServer
             .requestHandler(req -&gt; {    // Register a request handler for the HttpServer
                 req.response().end(response);
             })
             .listen(8080, "127.0.0.1"); // Listen on port 8080 and interface `127.0.0.1`
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You’ll see that we chained the createHttpServer() method, which returns an HttpServer object, to the requestHandler() method. We then chained the requestHandler() method to the listen() method. Each of these chained methods returns the original HttpServer object so that we can make subsequent calls in a fluent manner.</p>
</div>
</div>
<div class="sect2">
<h3 id="__strong_exercise_3_strong_handlers"><strong>Exercise 3:</strong> Handlers</h3>
<div class="paragraph">
<p>A handler in Vert.x is a form of <a href="https://en.wikipedia.org/wiki/Callback_(computer_programming">Callback</a>). Handlers are passed as arguments to some Vert.x methods so that the callback can be executed once a particular asynchronous operation has been completed. Handlers for Vert.x can be written in Groovy in several ways:</p>
</div>
<div class="sect3">
<h4 id="__strong_exercise_3_1_strong_handler_classes"><strong>Exercise 3.1:</strong> Handler classes</h4>
<div class="paragraph">
<p>The basic Handler in Vert.x is any class which implements the <a href="http://vertx.io/docs/apidocs/io/vertx/core/Handler.html">Handler</a> interface. For example:</p>
</div>
<div class="listingblock">
<div class="title">Exercise3/Exercise3_1.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.Handler;;
import io.vertx.core.AbstractVerticle;;
import io.vertx.core.json.JsonObject;;
import io.vertx.core.http.HttpServerRequest;;

public class Exercise3_1 extends AbstractVerticle {

    private class RequestHandler implements Handler&lt;HttpServerRequest&gt; {
        public void handle(HttpServerRequest req) {
            String response = new JsonObject().put("ok", true).encode();
            req.response().end(response);
        }
    }

    public void start() {
        vertx.createHttpServer()                     // Create a new HttpServer
             .requestHandler(new RequestHandler())
             .listen(8080, "127.0.0.1");  // Listen on port 8080 and interface `127.0.0.1`
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, we pass an instance of the RequestHandler class to the requestHandler() method on the HttpServer object and that instance will handle the HTTP requests.</p>
</div>
</div>
<div class="sect3">
<h4 id="__strong_exercise_3_2_strong_method_references"><strong>Exercise 3.2:</strong> Method References</h4>
<div class="paragraph">
<p>Another way to implement handlers removes some of the boiler-plate of having a separate hanlder class for each Callback we want to register. It’s called a <a href="http://docs.groovy-lang.org/latest/html/documentation/#method-pointer-operator">Method Reference</a>. A method reference is a way of assigning a method to behave as a callback without having to implement a Handler interface on a new class.</p>
</div>
<div class="listingblock">
<div class="title">Exercise3/Exercise3_2.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AbstractVerticle;;
import io.vertx.core.json.JsonObject;;
import io.vertx.core.http.HttpServerRequest;;

public class Exercise3_2 extends AbstractVerticle {

    /**
     * Handle HttpServerRequests
     */
    public void handleRequest(HttpServerRequest req) {
        String response = new JsonObject().put("ok", true).encode();
        req.response().end(response);
    }

    public void start() {
        vertx.createHttpServer()                      // Create a new HttpServer
             .requestHandler(this::handleRequest)     // Register a request handler
             .listen(8080, "127.0.0.1");   // Listen on port 8080 and interface `127.0.0.1`
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="__strong_exercise_3_3_strong_lambdas"><strong>Exercise 3.3:</strong> Lambdas</h4>
<div class="paragraph">
<p>Finally, in Java we can use <a href="https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html">Lambdas</a>. Lambdas are a way of writing a bit of code which can be passed as a value . . . in-line…</p>
</div>
<div class="listingblock">
<div class="title">Exercise3/Exercise3_3.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AbstractVerticle;;
import io.vertx.core.json.JsonObject;;

public class Exercise3_3 extends AbstractVerticle {

    public void start() {
        // Create a JSON response
        String response = new JsonObject().put("ok", true).encode();

        vertx.createHttpServer()         // Create a new HttpServer
             .requestHandler(req -&gt; {    // Register a request handler
                 req.response().end(response);
             })
             .listen(8080, "127.0.0.1"); // Listen on port 8080 and interface `127.0.0.1`
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An alternate way of declaring that closure would be to assign the closure to a variable and then pass the variable into the requestHandler() method as shown below:</p>
</div>
<div class="listingblock">
<div class="title">Exercise3/Exercise3_3_1.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AbstractVerticle;;
import io.vertx.core.json.JsonObject;;
import io.vertx.core.http.HttpServerRequest;;

public class Exercise3_3_1 extends AbstractVerticle {


    public void reqHandler(HttpServerRequest req) {
        String response = new JsonObject().put("ok", true).encode();
        req.response().end(response);
    }

    public void start() {
        vertx.createHttpServer()         // Create a new HttpServer
             .requestHandler(this::reqHandler) // Register a request handler
             .listen(8080, "127.0.0.1"); // Listen on port 8080 and interface `127.0.0.1`
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next Steps: (see <a href="http://vertx.io/docs/apidocs/io/vertx/core/http/HttpServerRequest.html">HttpServerRequest</a>)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Modify the example above to include the requested path as an item in the JSON response body</p>
</li>
<li>
<p>Modify the example above to include the request headers as a nested JSON object within the response body</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="__strong_exercise_4_strong_using_routers"><strong>Exercise 4:</strong> Using Routers</h3>
<div class="paragraph">
<p>So far, we have seen that we can add a requestHandler() to an HTTP server, but what if we want to have a number of different paths which do different things in our web application? This is where the Vert.x Web module comes in. It gives us a new features like <a href="http://vertx.io/docs/apidocs/io/vertx/ext/web/Router.html">Router</a> and <a href="http://vertx.io/docs/apidocs/io/vertx/ext/web/RoutingContext.html">RoutingContext</a>.</p>
</div>
<div class="listingblock">
<div class="title">Exercise4/Exercise4.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AbstractVerticle;;
import io.vertx.ext.web.Router;;
import io.vertx.ext.web.RoutingContext;;
import io.vertx.core.json.JsonObject;;

public class Exercise4 extends AbstractVerticle {

    public void start() {
        Router router = Router.router(vertx);

        router.get("/")              .handler(this::rootHandler);
        router.get("/something/else").handler(this::otherHandler);

        vertx.createHttpServer()                         // Create a new HttpServer
             .requestHandler(router::accept)             // Register a request handler
             .listen(8080, "127.0.0.1");      // Listen on 127.0.0.1:8080
    }

    public void rootHandler(RoutingContext ctx) {
        ctx.response().end(new JsonObject().put("ok", true).put("path", ctx.request().path()).encode());
    }

    public void otherHandler(RoutingContext ctx) {
        ctx.response().end(new JsonObject().put("ok", false).put("message", "Something Else").encode());
    }
}</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You see that we added 2 different routes to the Router instance</p>
</li>
<li>
<p>Each route has a separate handler set via a method reference</p>
</li>
<li>
<p>Finally, we pass the Router’s accept method via a method reference as a handler for the HttpServer’s requestHandler() method.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="__strong_exercise_5_strong_routes_with_path_parameters"><strong>Exercise 5:</strong> Routes with Path Parameters</h3>
<div class="paragraph">
<p>In the previous example, we saw that we could specify different paths with different handlers, but what about if we want to capture information FROM the path in a programmatic manner?</p>
</div>
<div class="listingblock">
<div class="title">Exercise5/Exercise5.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AbstractVerticle;
import io.vertx.ext.web.Router;
import io.vertx.ext.web.RoutingContext;
import io.vertx.core.json.JsonObject;

public class Exercise5 extends AbstractVerticle {

    public void start() {
        Router router = Router.router(vertx);

        router.get("/")            .handler(this::rootHandler);
        router.get("/customer/:id").handler(this::custHandler);

        vertx.createHttpServer()             // Create a new HttpServer
            .requestHandler(router::accept) // Register a request handler
            .listen(8080, "127.0.0.1");      // Listen on 127.0.0.1:8080
    }

    void rootHandler(RoutingContext ctx) {
        ctx.response().end(new JsonObject()
                                    .put("ok", true).put("path", ctx.request().path()).encode());
    }

    void custHandler(RoutingContext ctx) {
        ctx.response().end(new JsonObject()
           .put("ok", false)
           .put("custID", ctx.request().getParam("id"))
           .encode());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next Steps: (see <a href="http://vertx.io/docs/apidocs/io/vertx/ext/web/Router.html">Router</a>, <a href="http://vertx.io/docs/vertx-web/groovy/#_routing_with_regular_expressions">Routing With Regular Expressions</a>, <a href="http://vertx.io/docs/vertx-web/groovy/#_routing_based_on_mime_type_of_request">Routing Based On MIME Types</a>, <a href="http://vertx.io/docs/vertx-web/groovy/#_request_body_handling">Request Body Handling</a>)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Modify the example above to have a new route which had multiple path parameters</p>
</li>
<li>
<p>Modify the example above to use a route with regular expressions</p>
</li>
<li>
<p>Modify the example to add a new HTTP POST endpoint which consumes JSON and produces the POSTed JSON</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="__strong_exercise_6_strong_programmatically_deploy_verticles"><strong>Exercise 6:</strong> Programmatically Deploy Verticles</h3>
<div class="paragraph">
<p>So far, our exercised have done all of their work in a single Verticle (HelloWorld). This is fine for simple applications, but it does not scale well for larger and more complex applications. Each Verticle is single-threaded; so in order to utilize our CPU cores effectively, we need to distribute workloads across multiple Verticles.</p>
</div>
<div class="listingblock">
<div class="title">Exercise6/EventVerticle.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AbstractVerticle;
import io.vertx.core.eventbus.Message;
import io.vertx.core.json.JsonObject;

public class EventVerticle extends AbstractVerticle {

    @Override
    public void start() {
        vertx.eventBus().consumer("event.verticle", this::doSomething);
    }

    void doSomething(Message&lt;JsonObject&gt; msg) {
        if ((Math.round(Math.random()*1))==1) {
            msg.reply(msg.body());
        } else {
            msg.fail(1, "Random Failure");
	    }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Exercise6/Exercise6.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AsyncResult;
import io.vertx.core.AbstractVerticle;
import io.vertx.core.http.HttpServerResponse;
import io.vertx.ext.web.Router;
import io.vertx.ext.web.RoutingContext;
import io.vertx.core.json.JsonObject;
import io.vertx.core.eventbus.Message;

public class Exercise6 extends AbstractVerticle {

    public void start() {
        Router router = Router.router(vertx);

        router.get().handler(this::rootHandler);

        vertx.createHttpServer()            // Create a new HttpServer
            .requestHandler(router::accept) // Register a request handler
            .listen(8080, "127.0.0.1");      // Listen on 127.0.0.1:8080
        vertx.deployVerticle("java:EventVerticle.java");
    }

    void rootHandler(RoutingContext ctx) {
        JsonObject msg = new JsonObject().put("path", ctx.request().path());
        vertx.eventBus().send("event.verticle", msg, reply -&gt; this.replyHandler(ctx, reply));
    }

    void replyHandler(RoutingContext ctx, AsyncResult&lt;Message&lt;Object&gt;&gt; reply) {
        HttpServerResponse response = ctx.response()
                          .putHeader("Content-Type", "application/json");
        if (reply.succeeded()) {
            response.setStatusCode(200)
               .setStatusMessage("OK")
               .end(((JsonObject)reply.result().body()).encodePrettily());
        } else {
            response.setStatusCode(500)
               .setStatusMessage("Server Error")
               .end(new JsonObject().put("error", reply.cause().getLocalizedMessage()).encodePrettily());
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>(<strong>NOTE:</strong> When using <code><strong>vertx run &lt;VerticleName&gt;</strong></code> to launch Vert.x applications, the files should be in the current
working directory or a child directory referenced by it&#8217;s relative path)</p>
</div>
<div class="paragraph">
<p>Several new concepts have been introduced in this example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="http://vertx.io/docs/vertx-core/groovy/#event_bus">EventBus</a> - Used to communicate between Verticles in a
thread-safe manner</p>
</li>
<li>
<p>Deploying Verticles Programmatically</p>
</li>
<li>
<p>Handling <a href="http://vertx.io/docs/apidocs/io/vertx/core/AsyncResult.html">AsyncResult</a>s via Callback</p>
</li>
<li>
<p>Using <a href="http://vertx.io/docs/apidocs/io/vertx/core/eventbus/Message.html">Message</a> objects - Message objects consist of JsonObject or String contents and can be replied to</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="__strong_exercise_7_strong_deploy_with_futures"><strong>Exercise 7:</strong> Deploy With Futures</h3>
<div class="paragraph">
<p>Often, the application will need to ensure that certain Verticles are
already up and running before proceeding to do other actions. To allow for
this, Vert.x provides a way of deploying Verticles with a callback once
the deployment is complete.</p>
</div>
<div class="listingblock">
<div class="title">Exercise7/Exercise7.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AsyncResult;
import io.vertx.core.http.HttpServerResponse;
import io.vertx.core.json.JsonObject;
import io.vertx.core.eventbus.Message;
import io.vertx.core.logging.LoggerFactory;
import io.vertx.ext.web.Router;
import io.vertx.ext.web.RoutingContext;
import io.vertx.core.AbstractVerticle;

import static groovy.json.JsonOutput.toJson;

public class Exercise7 extends AbstractVerticle {

    public void start() {
        vertx.deployVerticle("java:EventVerticle.java", this::deployHandler);
    }

    void rootHandler(RoutingContext ctx) {
        JsonObject msg = new JsonObject().put("path", ctx.request().path());
        vertx.eventBus().send("event.verticle", msg, reply -&gt; this.replyHandler(ctx, reply));
    }

    void replyHandler(RoutingContext ctx, AsyncResult&lt;Message&lt;Object&gt;&gt; reply) {
        HttpServerResponse response = ctx.response()
                          .putHeader("Content-Type", "application/json");
        if (reply.succeeded()) {
            response.setStatusCode(200)
               .setStatusMessage("OK")
               .end(((JsonObject)reply.result().body()).encodePrettily());
        } else {
            response.setStatusCode(500)
               .setStatusMessage("Server Error")
               .end(new JsonObject().put("error", reply.cause().getLocalizedMessage()).encodePrettily());
        }
    }

    void deployHandler(AsyncResult&lt;String&gt; res) {
        if (res.succeeded()) {
            LoggerFactory.getLogger("Exercise7").info("Successfully deployed EventVerticle");

            // If the EventVerticle successfully deployed, configure and start the HTTP server
            Router router = Router.router(vertx);

            router.get().handler(this::rootHandler);

            vertx.createHttpServer()            // Create a new HttpServer
                .requestHandler(router::accept) // Register a request handler
                .listen(8080, "127.0.0.1");      // Listen on 127.0.0.1:8080
        } else {
            // Otherwise, exit the application
            LoggerFactory.getLogger("Exercise7").error("Failed to deploy EventVerticle", res.cause());
            vertx.close();
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Exercise7/EventVerticle.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.Future;
import io.vertx.core.json.JsonObject;
import io.vertx.core.eventbus.Message;
import io.vertx.core.AbstractVerticle;

public class EventVerticle extends AbstractVerticle {

    @Override
    public void start(Future startFuture) {
        vertx.eventBus().consumer("event.verticle", this::doSomething);

        if ((Math.round(Math.random()*1))==1) {            // Randomly succeed or fail deployment of EventVerticle
            startFuture.complete();
        } else {
            startFuture.fail("Random deployment failure of EventVerticle");
        }
    }

    void doSomething(Message&lt;JsonObject&gt; msg) {
        if (Math.random()&gt;=0.6666) {
            msg.reply(msg.body());
        } else {
            msg.fail(1, "Random Failure");
	    }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next Steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Modify the example above to attempt to redeploy EventVerticle in case of a failure (Use maximum of 3 retries)</p>
</li>
<li>
<p>Modify the example above to deploy more than one Verticle and call the new Verticle <code>AnotherVerticle.groovy</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_exercise_8_asynchronous_coordination">Exercise 8: Asynchronous Coordination</h3>
<div class="paragraph">
<p>It is useful to coordinate several asynchronous operations in a single handler for certain situations. To
facilitate this, Vert.x provides a <a href="http://vertx.io/docs/apidocs/io/vertx/core/CompositeFuture.html">CompositeFuture</a></p>
</div>
<div class="listingblock">
<div class="title">Exercise8/Exercise8.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AsyncResult;
import io.vertx.core.json.JsonObject;
import io.vertx.core.logging.LoggerFactory;
import io.vertx.core.CompositeFuture;
import io.vertx.core.Future;
import io.vertx.ext.web.Router;
import io.vertx.core.AbstractVerticle;
import io.vertx.ext.web.RoutingContext;

import java.util.stream.IntStream;

public class Exercise8 extends AbstractVerticle {
    public void start() {
        Future eventVerticleFuture = Future.future();
        Future anotherVerticleFuture = Future.future();

        CompositeFuture.join(eventVerticleFuture, anotherVerticleFuture).setHandler(this::deployHandler);

        vertx.deployVerticle("java:EventVerticle.java", eventVerticleFuture.completer());
        vertx.deployVerticle("java:AnotherVerticle.java", anotherVerticleFuture.completer());
    }

    protected void deployHandler(AsyncResult&lt;CompositeFuture&gt; cf) {
        if (cf.succeeded()) {
            LoggerFactory.getLogger("Exercise8").info("Successfully deployed all verticles");

            // If the EventVerticle successfully deployed, configure and start the HTTP server
            Router router = Router.router(vertx);

            router.get().handler(this::rootHandler);

            vertx.createHttpServer()            // Create a new HttpServer
                .requestHandler(router::accept) // Register a request handler
                .listen(8080, "127.0.0.1");      // Listen on 127.0.0.1:8080
        } else {
            IntStream.range(0, cf.result().size()).forEach(x -&gt; {
                if (cf.result().failed(x)) {
                    LoggerFactory.getLogger("Exercise8").error("Failed to deploy verticle", cf.result().cause(x));
                }
            });
            vertx.close();
        }
    }

    void rootHandler(RoutingContext ctx) {
        ctx.response().end(new JsonObject().put("ok", true).put("path", ctx.request().path()).encode());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next Steps: (see <a href="http://vertx.io/docs/apidocs/io/vertx/core/CompositeFuture.html">CompositeFuture</a> and
<a href="http://vertx.io/docs/vertx-core/groovy/#_sequential_composition">Async Coordination</a>)
* Modify the example above to use a List of futures instead of specifying each future as a parameter.
* Remove the CompositeFuture and use composed <a href="http://vertx.io/docs/apidocs/io/vertx/core/Future.html">Future</a>s to
  load one verticle after another</p>
</div>
</div>
<div class="sect2">
<h3 id="_exercise_9_using_shared_data">Exercise 9: Using Shared Data</h3>
<div class="paragraph">
<p>While you can coordinate between verticles very well using String and JsonObject instances over the EventBus, it is
sometimes better to share certain objects across multiple verticles. Vert.x makes this possible via 2 facilities.</p>
</div>
<div class="sect3">
<h4 id="_exercise_9_1_shared_local_map">Exercise 9.1: Shared Local Map</h4>
<div class="paragraph">
<p>The <a href="http://vertx.io/docs/apidocs/io/vertx/core/Vertx.html#sharedData--">Vertx.sharedData()</a> method allows us to get an
instance of <a href="http://vertx.io/docs/apidocs/io/vertx/core/shareddata/LocalMap.html">LocalMap</a> which can store most
Immutable data types as well as custom types which implement the <a href="http://vertx.io/docs/apidocs/io/vertx/core/shareddata/Shareable.html">Shareable</a>
interface. Storing data in a these LocalMap instances makes those objects available to other Verticles without having to
use the EventBus to send those objects. <strong>The Shared Local Map has no concurrency controls, so the last writer is always
the winner. If assurance of ordered writes is required, then the user must implement their own concurrency controls or
only use data structures which ensure thread safety.</strong></p>
</div>
<div class="listingblock">
<div class="title">Exercise9/Exercise9_1.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.logging.LoggerFactory;
import io.vertx.core.AbstractVerticle;
import io.vertx.core.shareddata.LocalMap;

import java.util.stream.IntStream;

public class Exercise9_1 extends AbstractVerticle {

    @Override
    public void start() throws Exception {

        // Deploy AnotherVerticle 10 times
        IntStream.rangeClosed(1, 10).forEach(i -&gt; {
            vertx.deployVerticle("java:AnotherVerticle.java");
        });

        vertx.setPeriodic(100, this::showDeployedVerticles);
    }

    void showDeployedVerticles(Long t) {
        // Print the list of deployment IDs stored in the shared data local Map
        LoggerFactory.getLogger("Exercise9_1").info("Polling shared data map");
        LocalMap&lt;String, Object&gt; localMap = vertx.sharedData().getLocalMap("shared");
        localMap.keySet().stream().forEach(key -&gt; {
            System.out.println(key+" - "+localMap.get(key));
        });
        System.out.println();
        System.out.println();
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Exercise9/AnotherVerticle.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.logging.LoggerFactory;
import io.vertx.core.AbstractVerticle;

public class AnotherVerticle extends AbstractVerticle {

    @Override
    public void start() throws Exception {
        vertx.sharedData().getLocalMap("shared").put(context.deploymentID(), Thread.currentThread().getName());

        LoggerFactory.getLogger("AnotherVerticle").info("Deployed AnotherVerticle: ${context.deploymentID()}");
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exercise_9_2_clustered_async_map">Exercise 9.2: Clustered Async Map</h4>
<div class="paragraph">
<p>When running in a clustered configuration, sharing objects across Vert.x nodes requires a special feature known as
<a href="http://vertx.io/docs/apidocs/io/vertx/core/shareddata/AsyncMap.html">AsyncMap</a>. The AsyncMap is handled by the Vert.x
<a href="http://vertx.io/docs/apidocs/io/vertx/core/spi/cluster/ClusterManager.html">ClusterManager</a>, which is responsible for
ensuring that access to the AsyncMap data is handled in a cluster/thread-safe way. In order to use the AsyncMap, Vert.x
<strong>MUST</strong> be started in a clustered mode using <code>vertx run -cluster &lt;Verticle&gt;</code></p>
</div>
<div class="listingblock">
<div class="title">Exercise9/Exercise9_2.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.logging.LoggerFactory;
import io.vertx.core.AbstractVerticle;

import java.util.Arrays;
import java.util.List;
import java.util.stream.IntStream;

public class Exercise9_2 extends AbstractVerticle {

    @Override
    public void start() throws Exception {

        // Get a reference to clusterWide map called "shared"
        vertx.sharedData().getClusterWideMap("shared", res -&gt; {
            if (res.succeeded()) {
                // Write to the map and await success
                res.result().put("deployments", Arrays.asList(context.deploymentID()), res1 -&gt; {
                    // Deploy AnotherVerticle 10 times
                        IntStream.rangeClosed(1, 10).forEach(i -&gt; {
                        vertx.deployVerticle("java:ClusteredVerticle.java");
                    });
                });
            }
        });

        vertx.setPeriodic(100, this::showDeployedVerticles);
    }

    void showDeployedVerticles(Long t) {
        // Print the list of deployment IDs stored in the shared data local Map
        LoggerFactory.getLogger("Exercise9_2").info("Polling shared data map");

        // Get reference to clusterWide map called "shared"
        vertx.sharedData().getClusterWideMap("shared", res -&gt; {
            if (res.succeeded()) {
                // Get the "deployments" value from the AsyncMap
                res.result().get("deployments", res1 -&gt; {

                    // Iterate over list of values
                    ((List&lt;String&gt;)res1.result()).stream().forEach(it -&gt; {
                        System.out.println(it);
                    });
                    System.out.println();
                    System.out.println();
                });
            }
        });
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Exercise9/ClusteredVerticle.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.logging.LoggerFactory;
import io.vertx.core.AbstractVerticle;

import java.util.List;

public class ClusteredVerticle extends AbstractVerticle {

    @Override
    public void start() throws Exception {
        // Get a reference to clusterWide map called "shared"
        vertx.sharedData().getClusterWideMap("shared", res -&gt; {
            if (res.succeeded()) {
                // Get the "deployments" list
                res.result().get("deployments", res1 -&gt; {
                    List&lt;String&gt; deploymentList = (List&lt;String&gt;)res1.result();
                    deploymentList.add(context.deploymentID());

                    // Update the "deployments" list
                    res.result().put("deployments", deploymentList, res2 -&gt; {
                        LoggerFactory.getLogger("ClusteredVerticle").info("Deployed ClusteredVerticle: ${context.deploymentID()}");
                    });
                });
            }
        });
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This cluster-wide data coordination is complex, so it is always advisable to send shared data via the EventBus where
possible. The ClusterManager and the AsyncMap implementations ensure that access to and writing of clustered resources
are synchronized properly across the entire cluster and thust prevents race conditions. The negative impact being that
access to read/write clustered data is much slower.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exercise_10_a_tcp_echo_server">Exercise 10 - A TCP Echo Server</h3>
<div class="paragraph">
<p>As a quick introduction to the network server capabilities of Vert.x, Let&#8217;s implement a TCP Echo Server. An echo server
is a network socket server which accepts incoming data and sends the same data back as a response.</p>
</div>
<div class="listingblock">
<div class="title">Exercise10/Exercise10.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.buffer.Buffer;
import io.vertx.core.json.JsonObject;
import io.vertx.core.logging.LoggerFactory;
import io.vertx.core.net.NetServer;
import io.vertx.core.net.NetServerOptions;
import io.vertx.core.net.NetSocket;
import io.vertx.core.AbstractVerticle;

public class Exercise10 extends AbstractVerticle {

    public void start() {
        JsonObject opts = new JsonObject()
                .put("host", "0.0.0.0")
                .put("port", 1080)
                .put("logActivity", true);

        NetServer server = vertx.createNetServer(new NetServerOptions(opts));
        server.connectHandler(this::connectHandler).listen();
    }

    void connectHandler(NetSocket socket) {
        socket.handler(b -&gt; this.dataHandler(socket, b));
    }

    void dataHandler(NetSocket socket, Buffer b) {
        LoggerFactory.getLogger("Exercise10").info(b.toString());
        socket.write(b);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are some new things to learn in this example. For one, there is the introduction of NetServer and it&#8217;s associated
options; but that it mostly self-explanitory. The other thing to make note of is the use of the
<a href="http://vertx.io/docs/apidocs/io/vertx/core/buffer/Buffer.html">Buffer</a> object. From the Vert.x API documentation:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Most data is shuffled around inside Vert.x using buffers.
A buffer is a sequence of zero or more bytes that can read from or written to and which expands automatically as necessary to accommodate any bytes written to it. You can perhaps think of a buffer as smart byte array.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>You can think of *Buffer*s as a way of pushing around streams of bytes. Buffers also have some convenience methods
like <code>toString()</code>, <code>toJsonObject()</code>, and <code>toJsonArray()</code>. You can append to a Buffer using one of the provided append
methods which can handle input types like Int/Float/Short/Unsigned/String/Byte/Long/Double. There are also append
methods for storing data in the buffer in little-endian byte order.</p>
</div>
<div class="paragraph">
<p>Next Steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Modify the EchoServer above to take in some text (Latin characters, numbers, spaces, newlines ONLY), ignore non-text,
and send back <code>Hello &lt;text&gt;</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_exercise_11">Exercise 11</h3>
<div class="paragraph">
<p>Vert.x also has the ability to create UDP servers. Let&#8217;s see what a UDP echo server would look like in Vert.x:</p>
</div>
<div class="listingblock">
<div class="title">Exercise11/Exercise11.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.AsyncResult;
import io.vertx.core.Handler;
import io.vertx.core.logging.Logger;
import io.vertx.core.logging.LoggerFactory;
import io.vertx.core.datagram.DatagramPacket;
import io.vertx.core.datagram.DatagramSocket;
import io.vertx.core.AbstractVerticle;

public class Exercise11 extends AbstractVerticle {
    private final Logger LOG = LoggerFactory.getLogger("Exercise11");

    @Override
    public void start() throws Exception {
        DatagramSocket socket = vertx.createDatagramSocket();

        socket.listen(1080, "0.0.0.0", this::socketHandler);
    }

    void socketHandler(AsyncResult&lt;DatagramSocket&gt; res) {
        if (res.succeeded()) {
            // Successfully received a datagram
            DatagramSocket socket = res.result();
            socket.handler(p -&gt; this.datagramHandler(socket, p));
        }
    }

    void datagramHandler(DatagramSocket socket, DatagramPacket p) {
        socket.send(p.data(), p.sender().port(), p.sender().host(), this::sendHandler);
    }

    void sendHandler(AsyncResult&lt;DatagramSocket&gt; sent) {
        if (sent.succeeded()) {
            LOG.info("SUCCESS");
        } else {
            LOG.error("FAILED");
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next Steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Modify the EchoServer above to take in some text (Latin characters, numbers, spaces, newlines ONLY), ignore non-text,
and send back <code>Hello &lt;text&gt;</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_exercise_12">Exercise 12</h3>
<div class="paragraph">
<p>HTTP is a mainstay of software these days, so being able to make and handle HTTP requests is vital. Let&#8217;s see how Vert.x
make HTTP requests in an asynchronous manner:</p>
</div>
<div class="listingblock">
<div class="title">Exercise12/Exercise12.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.http.HttpClient;
import io.vertx.core.logging.Logger;
import io.vertx.core.logging.LoggerFactory;
import io.vertx.core.http.HttpClientResponse;
import io.vertx.core.AbstractVerticle;

public class Exercise12 extends AbstractVerticle {

    private static final Logger LOG = LoggerFactory.getLogger("Exercise12");

    @Override
    public void start() throws Exception {
        vertx.createHttpClient()
                          .getNow("www.google.com", "/", this::responseHandler);
    }

    void responseHandler(HttpClientResponse response) {
        if (response.statusCode()==200 &amp;&amp; response.statusMessage()=="OK") {
            LOG.info("Success!");
        } else {
            LOG.warn("Got "+response.statusCode()+" as the response code.");
        }
        vertx.close();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next Steps</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make an HTTP GET request which uses HTTP Basic Authentication</p>
</li>
<li>
<p>Make an HTTP POST request which sends a JSON body</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_exercise_13">Exercise 13</h3>
<div class="paragraph">
<p>We&#8217;ve covered a number of individual features of Vert.x, Async, and non-blocking APIs in Vert.x, but in this exercise we
will try to put a few different ones together. Here&#8217;s the scenario:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An HTTP server listening on port 8080</p>
</li>
<li>
<p>A web browser will make a request to the '/merged/' endpoint</p>
</li>
<li>
<p>The Vert.x application will execute several operations in parallel</p>
</li>
<li>
<p>Request the <code>www.google.com</code> index page</p>
</li>
<li>
<p>Read a file (Your choice, but make it a simple short file) from the filesystem</p>
</li>
<li>
<p>Perform a DNS lookup on <code>www.google.com</code></p>
</li>
<li>
<p>Once all of the parallel operations are complete, insert the file contents and the dns results into a <code>&lt;pre&gt;</code> block
before the ending <code>&lt;/body&gt;</code> tag in the html retrieved from Google (Note: <a href="http://naleid.com/blog/2008/05/19/dont-fear-the-regexp">Groovy Regex Replace</a>)</p>
</li>
<li>
<p>Return the modified Google index page to the browser</p>
</li>
<li>
<p>If ANY one of the async operations fails, return a 500 HTTP response with the exception&#8217;s <code>localizedMessage</code> value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is only one component here which you are not already familiar with, and that is the
<a href="http://vertx.io/docs/vertx-core/groovy/#_dns_client">DNSClient</a>. The DNS client relatively simple, and it will be left
up to you to read the documentation and use it.</p>
</div>
<div class="paragraph">
<p>Next Steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Modify the solution for Exercise 13 so that you can
<a href="http://vertx.io/docs/vertx-core/groovy/#_the_vertx_command_line">pass in</a> a <code>config.json</code> file from which the
application will <a href="http://vertx.io/docs/vertx-core/groovy/#_passing_configuration_to_a_verticle">read</a> the settings
for:</p>
<div class="ulist">
<ul>
<li>
<p>HTTP client host</p>
</li>
<li>
<p>HTTP client URI</p>
</li>
<li>
<p>HTTP client port</p>
</li>
<li>
<p>HTTP client SSL enable/disable</p>
</li>
<li>
<p>DNS hostname to be resolved</p>
</li>
<li>
<p>Filename to be read</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_exercise_14">Exercise 14</h3>
<div class="paragraph">
<p>Let&#8217;s jump back into <code>vertx-web</code> again a little deeper&#8230;&#8203; One interesting aspect of the <code>Router</code> and <code>RoutingContext</code> is
that routes can be <strong>chained</strong>. What this means is that if you have a path which starts with <code>/rest</code>, and all routes
under that path will all do some of the same tasks, you can extract those operations into an earlier route which then
calls <code>RoutingContext.next()</code> and the request will be processed by other routes which might match. Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="title">Exercise14/Exercise14.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import io.vertx.core.json.JsonObject;
import io.vertx.ext.web.Router;
import io.vertx.ext.web.RoutingContext;
import io.vertx.core.AbstractVerticle;

import static io.netty.handler.codec.http.HttpResponseStatus.OK;
import static io.netty.handler.codec.http.HttpResponseStatus.UNAUTHORIZED;

public class Exercise14 extends AbstractVerticle {

    @Override
    public void start() throws Exception {
        Router router = Router.router(vertx);

        router.route().handler(this::authHandler);
        router.route("/rest/*").handler(this::restHandler);
        router.get("/rest/customer/:id").handler(this::customerByIdHandler);

        vertx.createHttpServer().requestHandler(router::accept).listen(8080, "0.0.0.0");
    }

    void authHandler(RoutingContext ctx) {
        // Do something to validate authentication
        ctx.put("authenticated", true);
        ctx.next();
    }

    void restHandler(RoutingContext ctx) {
        // All REST requests will have certain common requirements

        ctx.response()
            .putHeader("Content-Type", "application/json") // Set the response Content-Type to application/json
            .putHeader("Cache-Control", "nocache") // Disable caching for browsers which respect this header
            .putHeader("Expires", "Tue, 15 Nov 1994 12:45:26 GMT"); // Set some expiry date in the past to help prevent caching
        ctx.next();
    }

    void customerByIdHandler(RoutingContext ctx) {
        if (ctx.get("authenticated")) {
            // The "authenticated" value is set in the authHandler method/route, and so it should be present here!!
            ctx.response().setStatusCode(OK.code())
                          .setStatusMessage(OK.reasonPhrase())
                          .end(new JsonObject().put("authenticated", true).encodePrettily());  // The headers set in restHandler are already set as well!
        } else {
            ctx.response().setStatusCode(UNAUTHORIZED.code())
                          .setStatusMessage(UNAUTHORIZED.reasonPhrase())
                          .end("{}");  // The headers set in restHandler are already set as well!
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this, admittedly contrived, example; we see that any request which matches '/rest/customer/:id' will match all of the
previous routes as well. Since the handlers for each of those routes are calling <code>RoutingContext.next()</code> on the
RoutingContext object, ALL of these handlers will be applied in order!</p>
</div>
<div class="paragraph">
<p>Next Steps:
* Do some research in the Vert.x documentation, and determine how to add a <strong>catch-all</strong> route which will handle any
  previously unhandled requests by sending a custom JSON 404 response
* Create a <strong>catch-all</strong> route which will instead serve up <a href="http://vertx.io/docs/vertx-web/groovy/#_serving_static_resources">static filesystem resources</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_exercise_15">Exercise 15</h3>
<div class="paragraph">
<p>Now that we have a basic understanding of event based programming in Vert.x, let&#8217;s learn how we can test our code when operating in an asynchronous world.
In this example we will have a single Verticle which sets itself up to listen on the event bus. And using <a href="http://www.spockframework.org">Spock Framework</a> we
will add a behavior test in order to make sure that our Verticle functions as expected.</p>
</div>
<div class="listingblock">
<div class="title">Exercise15/src/main/java/com/redhat/labs/vertx/exercise15/Main.java</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package com.redhat.labs.vertx.exercise15;

import io.vertx.core.AbstractVerticle;
import io.vertx.core.Future;
import io.vertx.core.json.JsonObject;

public class Main extends AbstractVerticle {

    @Override
    public void start(Future&lt;Void&gt; startFuture) throws Exception {
        vertx.eventBus().consumer("test.address", msg -&gt; {
            msg.reply(new JsonObject().put("ok", true).put("message", "SUCCESS"));
        });

        startFuture.complete();
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Exercise15/src/test/groovy/com/redhat/labs/vertx/exercise15/MainSpec.groovy</div>
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">package com.redhat.labs.vertx.exercise15

import io.vertx.core.Vertx
import io.vertx.core.json.JsonObject
import spock.lang.Specification
import spock.util.concurrent.AsyncConditions

class MainSpec extends Specification {

    def "Test static message handler"() {
        given: "An instance of Vert.x, a deployed Main verticle, and an AsyncCondition" <b class="conum">(1)</b>
            def async = new AsyncConditions(2)                          <b class="conum">(2)</b>
            def vertx = Vertx.vertx()
            vertx.deployVerticle(new Main(), { res -&gt;
                async.evaluate {                                        <b class="conum">(3)</b>
                    // Verticle was successfully deployed
                    res.succeeded() == true
                }
            })
            def result = null as JsonObject

        when: "A message is sent on the event bus to 'test.address'"    <b class="conum">(4)</b>
            vertx.eventBus().send('test.address', new JsonObject([ok: true]), { reply -&gt;
                async.evaluate {                                        <b class="conum">(5)</b>
                    reply.succeeded() == true
                    result = reply.result().body() as JsonObject
                    result.getBoolean("ok") == true
                    result.getString("message") == 'SUCCESS'
                }
            })

        then: "The reply to the message must match expectations"        <b class="conum">(6)</b>
            async.await(10)                                             <b class="conum">(7)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Spock uses <a href="https://github.com/cucumber/cucumber/wiki/Gherkin">Gherkin</a> style syntax in the form of <strong>given</strong>, <strong>when</strong>, <strong>then</strong></p>
</li>
<li>
<p>When testing asynchronous code, Spock gives you an <strong>AsyncConditions</strong> class which can be used to coordinate. The number passed indicates the number of async evaluation blocks which will need to be processed</p>
</li>
<li>
<p>This is an async evaluation block. In this case it checks to ensure that the Verticle is successfully deployed. Any assertions in this block must succeed or the test will fail</p>
</li>
<li>
<p>The <strong>when</strong> block is where we place the code to be tested</p>
</li>
<li>
<p>Another async evaluation block, this time checking to ensure that the reply message is correct</p>
</li>
<li>
<p>The <strong>then</strong> block is where we tell the system to check our work</p>
</li>
<li>
<p>The <code>async.await(10)</code> call tells Spock to wait for 10 seconds for the 2 async conditions to complete, and if it times out the test fails.</p>
</li>
</ol>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-05-26 16:34:41 EDT
</div>
</div>
</body>
</html>